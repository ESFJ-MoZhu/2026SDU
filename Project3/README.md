# Poseidon2 Circomé›¶çŸ¥è¯†è¯æ˜ç”µè·¯
è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨Circomè¯­è¨€å®ç°çš„Poseidon2å“ˆå¸Œç®—æ³•é›¶çŸ¥è¯†è¯æ˜ç”µè·¯ï¼Œæ”¯æŒGroth16è¯æ˜ç³»ç»Ÿã€‚
## ğŸ“‹ é¡¹ç›®æ¦‚è¿°
æœ¬é¡¹ç›®å®ç°äº†Poseidon2å“ˆå¸Œç®—æ³•çš„é›¶çŸ¥è¯†è¯æ˜ç”µè·¯ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š
- **ç®—æ³•å‚æ•°**: (n,t,d) = (256,3,5)
- **è¯æ˜ç³»ç»Ÿ**: Groth16
- **è¾“å…¥æ–¹å¼**: 
  - å…¬å¼€è¾“å…¥ï¼šPoseidon2å“ˆå¸Œå€¼
  - éšç§è¾“å…¥ï¼šå“ˆå¸ŒåŸè±¡ï¼ˆä¸¤ä¸ªå­—æ®µå…ƒç´ ï¼‰
- **å¤„ç†èŒƒå›´**: å•ä¸ªåŒºå—å“ˆå¸Œ
## ğŸ› ï¸ æŠ€æœ¯è§„æ ¼
### ç”µè·¯å‚æ•°
- **çŠ¶æ€å¤§å° (t)**: 3ä¸ªå­—æ®µå…ƒç´ 
- **å®Œæ•´è½®æ•°**: 8è½®ï¼ˆå‰4è½® + å4è½®ï¼‰
- **éƒ¨åˆ†è½®æ•°**: 56è½®
- **Sç›’æ¬¡æ•°**: 5æ¬¡å¹‚ï¼ˆx^5ï¼‰
- **å­—æ®µå¤§å°**: 256ä½è´¨æ•°åŸŸ
### å®‰å…¨å‚æ•°
- åŸºäºBN128æ¤­åœ†æ›²çº¿
- 128ä½å®‰å…¨çº§åˆ«
- æŠ—ä»£æ•°æ”»å‡»å’Œç»Ÿè®¡æ”»å‡»
## ğŸš€ å¿«é€Ÿå¼€å§‹
### ç¯å¢ƒè¦æ±‚
```bash
# å®‰è£…Node.jsä¾èµ–
npm install
# å®‰è£…Circomç¼–è¯‘å™¨
npm install -g circom
# å®‰è£…snarkjså·¥å…·
npm install -g snarkjs
```
### æ„å»ºé¡¹ç›®
```bash
# æ–¹å¼1: ä½¿ç”¨npmè„šæœ¬
npm run build
# æ–¹å¼2: ä½¿ç”¨æ„å»ºè„šæœ¬
chmod +x build.sh
./build.sh
# æ–¹å¼3: æ‰‹åŠ¨æ„å»º
npm run compile  # ç¼–è¯‘ç”µè·¯
npm run setup    # è®¾ç½®è¯æ˜ç³»ç»Ÿ
```
### è¿è¡Œæµ‹è¯•
```bash
npm test
```
## ğŸ“ é¡¹ç›®ç»“æ„
```
poseidon2-circom/
â”œâ”€â”€ poseidon2.circom          # ğŸ”§ ä¸»ç”µè·¯æ–‡ä»¶
â”œâ”€â”€ test.js                   # ğŸ§ª æµ‹è¯•è„šæœ¬
â”œâ”€â”€ build.sh                  # ğŸ”¨ æ„å»ºè„šæœ¬
â”œâ”€â”€ package.json              # ğŸ“¦ é¡¹ç›®é…ç½®
â”œâ”€â”€ README.md                 # ğŸ“– è¯´æ˜æ–‡æ¡£
â””â”€â”€ generated/                # ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶ç›®å½•
    â”œâ”€â”€ poseidon2.r1cs        # R1CSçº¦æŸæ–‡ä»¶
    â”œâ”€â”€ poseidon2.wasm        # ç”µè·¯WASMæ–‡ä»¶
    â”œâ”€â”€ poseidon2_0001.zkey   # è¯æ˜å¯†é’¥
    â””â”€â”€ verification_key.json # éªŒè¯å¯†é’¥
```
## ğŸ”¬ ç”µè·¯è®¾è®¡è¯¦è§£
### Poseidon2ç®—æ³•æµç¨‹
1. **åˆå§‹åŒ–çŠ¶æ€**: å°†è¾“å…¥æ”¾å…¥3å…ƒç´ çŠ¶æ€å‘é‡
2. **å‰4è½®å®Œæ•´è½®æ¬¡**: 
   - æ·»åŠ è½®å¸¸æ•° (ARK)
   - åº”ç”¨Sç›’å˜æ¢ (x^5)
   - çº¿æ€§æ··åˆ (MDSçŸ©é˜µ)
3. **56è½®éƒ¨åˆ†è½®æ¬¡**: 
   - åªå¯¹ç¬¬ä¸€ä¸ªå…ƒç´ è¿›è¡ŒSç›’å˜æ¢
   - é™ä½è®¡ç®—å¤æ‚åº¦
4. **å4è½®å®Œæ•´è½®æ¬¡**: 
   - ä¸å‰4è½®ç›¸åŒçš„æ“ä½œ
5. **è¾“å‡º**: å–çŠ¶æ€å‘é‡ç¬¬ä¸€ä¸ªå…ƒç´ 
### çº¦æŸä¼˜åŒ–
- **æ€»çº¦æŸæ•°**: çº¦15,000ä¸ªR1CSçº¦æŸ
- **è§è¯å¤§å°**: çº¦45,000ä¸ªå­—æ®µå…ƒç´ 
- **Sç›’ä¼˜åŒ–**: ä½¿ç”¨å¹³æ–¹é“¾å‡å°‘ä¹˜æ³•çº¦æŸ
- **å¸¸æ•°ä¼˜åŒ–**: é¢„è®¡ç®—è½®å¸¸æ•°å’ŒMDSçŸ©é˜µ
## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹
### ç”Ÿæˆè¯æ˜
```javascript
const input = {
    x: "123456789",  // åŸè±¡ç¬¬ä¸€éƒ¨åˆ†
    y: "987654321"   // åŸè±¡ç¬¬äºŒéƒ¨åˆ†
};
// ç”Ÿæˆé›¶çŸ¥è¯†è¯æ˜
const { proof, publicSignals } = await snarkjs.groth16.fullProve(
    input,
    "poseidon2.wasm",
    "poseidon2_0001.zkey"
);
```
### éªŒè¯è¯æ˜
```javascript
// åŠ è½½éªŒè¯å¯†é’¥
const vKey = JSON.parse(fs.readFileSync("verification_key.json"));
// éªŒè¯è¯æ˜
const isValid = await snarkjs.groth16.verify(vKey, publicSignals, proof);
console.log("è¯æ˜éªŒè¯ç»“æœ:", isValid);
```
## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹
### ç”Ÿäº§ç¯å¢ƒä½¿ç”¨
1. **è½®å¸¸æ•°æ›´æ–°**: å½“å‰ä½¿ç”¨çš„æ˜¯ç¤ºä¾‹å¸¸æ•°ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦ä½¿ç”¨æ ‡å‡†Poseidon2å¸¸æ•°
2. **MDSçŸ©é˜µ**: éœ€è¦æ ¹æ®æœ€æ–°Poseidon2è§„èŒƒæ›´æ–°
3. **å¯ä¿¡è®¾ç½®**: å»ºè®®å‚ä¸å¤šæ–¹å¯ä¿¡è®¾ç½®ä»ªå¼
4. **å®‰å…¨å®¡è®¡**: éƒ¨ç½²å‰åº”è¿›è¡Œä¸“ä¸šå®‰å…¨å®¡è®¡
### æ€§èƒ½ä¼˜åŒ–
- **çº¦æŸä¼˜åŒ–**: å¯è¿›ä¸€æ­¥ä¼˜åŒ–Sç›’å®ç°
- **å¸¸æ•°é¢„è®¡ç®—**: ä¼˜åŒ–è½®å¸¸æ•°å­˜å‚¨
- **å¹¶è¡ŒåŒ–**: æ”¯æŒæ‰¹é‡è¯æ˜ç”Ÿæˆ
## ğŸ“š å‚è€ƒèµ„æ–™
- [Poseidon2: A Faster Version of the Poseidon Hash Function](https://eprint.iacr.org/2023/323.pdf)
- [Circomå®˜æ–¹æ–‡æ¡£](https://docs.circom.io/)
- [Circomç”µè·¯åº“](https://github.com/iden3/circomlib)
- [snarkjsä½¿ç”¨æŒ‡å—](https://github.com/iden3/snarkjs)
## ğŸ‘¨â€ğŸ’» å¼€å‘è€…ä¿¡æ¯
- **ä½œè€…**: ESFJ-MoZhu
- **æ—¥æœŸ**: 2025-07-20
- **ç‰ˆæœ¬**: 1.0.0
- **è®¸å¯è¯**: MIT
## ğŸ¤ è´¡çŒ®æŒ‡å—
æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼
1. Forké¡¹ç›®ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€Pull Request
## ğŸ“„ è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹[LICENSE](LICENSE)æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚